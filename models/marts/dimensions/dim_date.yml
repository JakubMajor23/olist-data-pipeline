version: 2

models:
  - name: dim_date
    description: "Date dimension, generated by dbt_utils.date_spine. Includes a special '0' key row to handle NULL foreign keys in fact tables."

    columns:
      - name: data_key
        description: "Surrogate primary key (YYYYMMDD integer format). The '0' key represents unknown or N/A dates."
        tests:
          - unique
          - not_null

      - name: calendar_date
        description: "The actual date value. NULL for the '0' key row."
        tests:
          - unique

      - name: year
        description: "The 4-digit year. NULL for the '0' key row."
        tests:
          - dbt_expectations.expect_column_values_to_be_between:
              min_value: 2016
              max_value: 2018

      - name: quarter
        description: "The quarter of the year (1-4). NULL for the '0' key row."
        tests:
          - dbt_expectations.expect_column_values_to_be_between:
              min_value: 1
              max_value: 4

      - name: month_num
        description: "The month number (1-12). NULL for the '0' key row."
        tests:
          - dbt_expectations.expect_column_values_to_be_between:
              min_value: 1
              max_value: 12

      - name: year_month
        description: "Year and month in 'YYYY-MM' format. 'N/A' for the '0' key row."
        tests:
          - not_null

      - name: month_name
        description: "Full name of the month (e.g., January). 'N/A' for the '0' key row."
        tests:
          - not_null
          - accepted_values:
              arguments:
                values: ['January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December', 'N/A']

      - name: day_of_month
        description: "Day of the month (1-31). NULL for the '0' key row."
        tests:
          - dbt_expectations.expect_column_values_to_be_between:
              min_value: 1
              max_value: 31


      - name: day_of_year
        description: "Day of the year (1-366). NULL for the '0' key row."
        tests:
          - dbt_expectations.expect_column_values_to_be_between:
              min_value: 1
              max_value: 366

      - name: day_of_week_num
        description: "Day of the week (ISO standard: 1=Monday, 7=Sunday). NULL for the '0' key row."
        tests:
          - dbt_expectations.expect_column_values_to_be_between:
              min_value: 1
              max_value: 7

      - name: day_of_week_name
        description: "Full name of the day (e.g., Monday). 'N/A' for the '0' key row."
        tests:
          - not_null
          - accepted_values:
              arguments:
                values: ['Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday', 'Sunday', 'N/A']

      - name: is_weekend
        description: "Boolean flag, TRUE if the day is a Saturday or Sunday."
        tests:
          - not_null
          - accepted_values:
              arguments:
                values: [True, False]